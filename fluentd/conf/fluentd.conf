<system>
 @log_level debug
</system>

<source>
 @type tail
 path /logs/events.log
 pos_file /fluentd/log/events.log.pos
 tag simulator.event
 <parse>
 @type regexp
 expression /^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}\.\d+) event=(?<event>\S+) user=(?<user>\S+) src_ip=(?<src_ip>\S+) dst_ip=(?<dst_ip>\S+).*$/
 time_key time
 time_format %Y-%m-%d %H:%M:%S.%N
 </parse>
 # Handle multiline logs if needed
 multiline_flush_interval 5s
</source>

<match simulator.event>
 @type kafka2
 brokers "#{ENV['KAFKA_BROKER']}"
 default_topic "#{ENV['KAFKA_EVENT_LOG_TOPIC']}"
 # Optional: Add format for the output message
 <format>
 @type json
 </format>
 # Optional: Buffer configuration for better performance
 <buffer>
 flush_interval 5s
 chunk_limit_size 1m
 flush_thread_count 2
 </buffer>
</match>